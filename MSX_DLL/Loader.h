#pragma once

#include <stdio.h>
#include <Windows.h>
#include <tchar.h>
#include <strsafe.h>
#include <fltUser.h>
#pragma comment(lib, "fltLib.lib")

class Loader
{
public:
protected:
private:
	PTCHAR driverName;

public:
	Loader(PTCHAR _driverName);
	virtual ~Loader(void);

	BOOLEAN InstallDriver(void);
	BOOLEAN UnInstallDriver(void);

	BOOLEAN StartDriver(void);
	BOOLEAN StopDriver(void);

protected:
private:
	// install step1
	BOOLEAN SetReg(void);
	BOOLEAN SetDriverReg(void);
	BOOLEAN SetDriverInstanceReg(void);
	BOOLEAN SetDriverInstanceSubReg(void);
	// install step2
	BOOLEAN SetDriverByService(void);
	// uninstall step1
	BOOLEAN ResetDriverByService(void);

	// start
	DWORD EnablePrivilege(TCHAR* privilegeStr);
};