#pragma pack(1)  

#pragma comment(lib,"FltLib")
typedef struct _SCANNER_NOTIFICATION {

	BOOL bCreate;
	ULONG Reserved;             // for quad-word alignement of the Contents structure  
	UCHAR ProcessName[MAX_PATH];

} SCANNER_NOTIFICATION, *PSCANNER_NOTIFICATION;

typedef struct _SCANNER_REPLY {

	BOOLEAN SafeToOpen;
	UCHAR   ReplyMsg[MAX_PATH];

} SCANNER_REPLY, *PSCANNER_REPLY;

typedef struct _SCANNER_MESSAGE
{

	//  
	//  Required structure header.  
	//  

	FILTER_MESSAGE_HEADER MessageHeader;


	//  
	//  Private scanner-specific fields begin here.  
	//  

	SCANNER_NOTIFICATION Notification;

	//  
	//  Overlapped structure: this is not really part of the message  
	//  However we embed it instead of using a separately allocated overlap structure  
	//  

	OVERLAPPED Ovlp;

} SCANNER_MESSAGE, *PSCANNER_MESSAGE;

typedef struct _SCANNER_REPLY_MESSAGE {

	//  
	//  Required structure header.  
	//  

	FILTER_REPLY_HEADER ReplyHeader;

	//  
	//  Private scanner-specific fields begin here.  
	//  

	SCANNER_REPLY Reply;

} SCANNER_REPLY_MESSAGE, *PSCANNER_REPLY_MESSAGE;