#ifndef _HEADER_HEAD_FILE  
#define _HEADER_HEAD_FILE  
#pragma once  
#include <fltKernel.h>  
#include <Ntstrsafe.h>  
#include "util.h"

#ifndef MAX_PATH  
#define MAX_PATH    260  
#endif  

typedef struct _SCANNER_NOTIFICATION {

	ULONG bCreate;
	ULONG Reserved;
	UCHAR ProcessName[MAX_PATH];
	ULONG flag; //2 ¶ó¸é LoadImageRoutineCallback
	UCHAR DLLName[MAX_PATH];

} SCANNER_NOTIFICATION, *PSCANNER_NOTIFICATION;

typedef struct _SCANNER_REPLY {

	BOOLEAN SafeToOpen;
	UCHAR   ReplyMsg[MAX_PATH];
} SCANNER_REPLY, *PSCANNER_REPLY;


void LoadImageInfo(LPSTR PROCESS_Name, PUNICODE_STRING DLL_NAME);
VOID FLTUNLOAD();
NTSTATUS FLTENTRY(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath);
NTSTATUS PtUnload(__in FLT_FILTER_UNLOAD_FLAGS Flags);

NTSTATUS PtInstanceQueryTeardown(__in PCFLT_RELATED_OBJECTS FltObjects, __in FLT_INSTANCE_QUERY_TEARDOWN_FLAGS Flags);


#endif  